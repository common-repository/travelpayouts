(self.travelpayoutsWpPlugin=self.travelpayoutsWpPlugin||[]).push([[57],{33711:e=>{e.exports={stylesTagWrapper:"styles-tag-wrapper__LJg60"}},87039:e=>{e.exports={stylesFooter:"styles-footer__BXPyg",stylesFooterSmall:"styles-footer--small__vkGxy",stylesWrapper:"styles-wrapper__zKCT3"}},88891:e=>{e.exports={stylesModalBody:"styles-modal-body__IH4Yn",stylesModalFooter:"styles-modal-footer__iQa4U"}},54016:e=>{e.exports={stylesTableFill:"styles-table--fill__TnjJQ",stylesTableIsLoading:"styles-table-is-loading__gZ6v4",stylesPagination:"styles-pagination__lLPAW",stylesPaginationTotalPages:"styles-pagination-totalPages__ufT9C",stylesPaginationTotalPagesPageNumber:"styles-pagination-totalPages-page-number__JXELh",stylesPaginationTotalPagesDelimiter:"styles-pagination-totalPages-delimiter__cb7Zt",stylesCheckbox:"styles-checkbox__MDh0W",stylesCheckboxCell:"styles-checkbox-cell__QC61s"}},17865:e=>{e.exports={stylesContainer:"styles-container__K8pzi"}},43960:e=>{e.exports={stylesWrapper:"styles-wrapper__vaObQ",stylesIcon:"styles-icon__KftFw",stylesId:"styles-id__Zg5w_",stylesText:"styles-text__ALgnI"}},24172:e=>{e.exports={stylesDescription:"styles-description__Nc_7n",stylesDescriptionContent:"styles-description-content__hiPBl",stylesDescriptionIcon:"styles-description-icon__YwVmI"}},88852:e=>{e.exports={stylesActionBar:"styles-action-bar__ElmAP",stylesActionBarButton:"styles-action-bar-button__RgB6f",stylesGridPagination:"styles-grid-pagination__wJcl_",stylesGridCellDate:"styles-grid-cell-date__v1a4n",stylesGridCellActions:"styles-grid-cell-actions__abV0Y"}},41820:e=>{e.exports={stylesDescription:"styles-description__spFrX",stylesActionBar:"styles-action-bar__ioLnF",stylesActionBarButton:"styles-action-bar-button__N2GO0",stylesHelpLink:"styles-help-link__upWKe"}},45399:e=>{e.exports={stylesCalloutWrapper:"styles-callout-wrapper__M5Tck",stylesTextarea:"styles-textarea__kdyGe",stylesFooterActions:"styles-footer-actions__c9Uri"}},57474:(e,t,a)=>{"use strict";a.d(t,{pE:()=>c,q6:()=>n,Vk:()=>i,rY:()=>o,Oe:()=>r,C0:()=>m,yH:()=>g,Vn:()=>u});var s=a(80809);a(27378);const n=e=>(0,s.HA)((({dialogProps:t,dialogConfig:a},{dispatch:s})=>{s(l({dialogName:e,dialogProps:t,dialogConfig:a}))})),r=e=>[(0,s.HA)((({dialogProps:t,dialogConfig:a},{dispatch:s})=>{s(l({dialogName:e,dialogProps:t,dialogConfig:a}))})),(0,s.HA)(((t,{dispatch:a})=>{a(o(e))})),e],l=(0,s.HA)("openDialog"),o=(0,s.HA)("closeDialog"),i=(0,s.HA)("closeAllDialogs"),c=(0,s.xy)("dialog",{},(e=>[e(l,((e,{dialogName:t,dialogProps:a={},dialogConfig:s={}})=>e[t]&&e[t].visible?e:Object.assign(Object.assign({},e),{[t]:{visible:!0,dialogConfig:s,dialogProps:a}}))),e(o,((e,t)=>e[t]?Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},e[t]),{visible:!1})}):e)),e(i,(()=>({})))])),d=(0,s.UI)((0,s.$e)([c]),(([e])=>t=>e[t])),u=(0,s.UI)((0,s.$e)([d]),(([e])=>t=>{const a=e(t);return a&&a.visible})),m=(0,s.UI)((0,s.$e)([d]),(([e])=>t=>{const a=e(t);return a&&a.dialogConfig})),g=(0,s.UI)((0,s.$e)([d]),(([e])=>t=>{const a=e(t);return a&&a.dialogProps}))},30463:(e,t,a)=>{"use strict";a.d(t,{c:()=>o});var s=a(60042),n=a.n(s),r=a(27378),l=a(88891);const o=e=>{const{children:t,className:a,style:s}=e;return r.createElement("div",{style:s,className:n()(l.stylesModalFooter,a)},t)}},75201:(e,t,a)=>{"use strict";a.d(t,{V:()=>d});var s=a(60042),n=a.n(s),r=a(27378),l=a(44057),o=a(60130),i=a(57474),c=a(88891);const d=e=>{const{name:t,width:a,className:s,destroyOnClose:d=!0,bodyComponent:u,canEscapeKeyClose:m=!0,canOutsideClickClose:g=!0,wrapBody:p=!0}=e,f=(0,o.KO)(i.Vn)(t),h=(0,o.KO)(i.C0)(t),y=(0,o.KO)(i.yH)(t),v=(0,o.BH)(i.rY),_=h&&h.title;if(!f&&d)return null;const b=()=>v(t);return r.createElement(l.Vq,{title:_,className:n()(s),style:{width:a},isOpen:f,onClose:b,canEscapeKeyClose:m,canOutsideClickClose:g,enforceFocus:!1},p?r.createElement("div",{className:n()(c.stylesModalBody)},r.createElement(u,Object.assign({closeDialog:b},y))):r.createElement(u,Object.assign({closeDialog:b},y)))}},80062:(e,t,a)=>{"use strict";a.d(t,{R:()=>l});a(27378);var s=a(44057),n=a(23413),r=a(17865);const l=s.x7.create({className:r.stylesContainer,position:n.Ly.TOP})},69032:(e,t,a)=>{"use strict";a.d(t,{Jw:()=>s,uj:()=>o,E8:()=>i});const s=e=>({disabled:!e.length,minimal:!0,fill:!0});var n=a(27378),r=a(27998),l=a(44057);const o=e=>(t,a)=>{const{modifiers:{active:s,disabled:r,matchesPredicate:o},handleClick:i,index:c}=a,d=e(t,a);return d&&o?n.createElement(l.sN,{key:c,active:s,disabled:r,onClick:r?void 0:i,text:d}):null},i=({items:e,itemsParentRef:t,query:a,renderItem:s})=>{const o=e.map(s).filter((e=>null!=e));return n.createElement(l.v2,{ulRef:t,style:{overflow:"inherit"}},n.createElement(r.ZP,{autoHeightMax:300,autoHeight:!0},o))}},89345:(e,t,a)=>{"use strict";a.r(t),a.d(t,{SearchForms:()=>Xe});a(36558),a(31173),a(7282);var s=a(27378),n=a(9246),r=a(14206),l=a.n(r),o=function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function l(e){try{i(s.next(e))}catch(e){r(e)}}function o(e){try{i(s.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}i((s=s.apply(e,t||[])).next())}))};const i=l().create({baseURL:"/wp-admin/admin-ajax.php",params:{action:"travelpayouts_routes"}});var c=a(80809),d=a(60042),u=a.n(d),m=a(27998),g=a(89003),p=a(44057),f=a(43960);const h=e=>{const{item:t}=e;return s.createElement("div",{className:u()(f.stylesWrapper)},s.createElement("div",{className:u()(f.stylesIcon)},s.createElement(p.JO,{icon:"trash"})),s.createElement("div",{className:u()(f.stylesText)},t.title))};var y=a(57474),v=a(75201),_=a(93192),b=a(30463),E=a(87039);const C=e=>s.createElement(b.c,{className:u()(E.stylesWrapper)},s.createElement("div",{className:u()(_.Alt,E.stylesFooter,{[E.stylesFooterSmall]:"small"===e.type})},s.createElement("div",{className:u()(_.e$L,e.className)},e.children)));var w=a(24172);const P=e=>{const{items:t,onConfirm:a,closeDialog:n}=e,{formatMessage:r}=(0,g.Z)();return s.createElement("div",null,s.createElement("div",{className:u()(w.stylesDescription)},s.createElement("div",{className:u()(w.stylesDescriptionIcon)},s.createElement(p.JO,{icon:"warning-sign",iconSize:20})),s.createElement("div",{className:u()(w.stylesDescriptionContent)},r({id:"grid_button_remove_items_description",defaultMessage:"{num, plural, one {# item} other {# items}} will be removed. This operation cannot be undone."},{num:t.length}))),s.createElement(m.ZP,{autoHeightMax:300,autoHeight:!0},s.createElement("div",null,t.map(((e,t)=>s.createElement(h,{key:t,item:e}))))),s.createElement(C,{type:"small"},s.createElement(p.zx,{onClick:()=>n()},r({id:"button_cancel",defaultMessage:"Cancel"})),s.createElement(p.zx,{intent:"danger",onClick:()=>a()},r({id:"button_delete",defaultMessage:"Delete"}))))},[O,x,S]=(0,y.Oe)("search-forms-delete"),A=()=>s.createElement(v.V,{name:S,bodyComponent:P,width:350,canEscapeKeyClose:!0,canOutsideClickClose:!0});var j=a(93386),H=a(93683),M=a(33098),N=function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function l(e){try{i(s.next(e))}catch(e){r(e)}}function o(e){try{i(s.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}i((s=s.apply(e,t||[])).next())}))};const I={request:(0,c.HA)("translations/request",((e,{dispatch:t})=>N(void 0,void 0,void 0,(function*(){const e=yield o(void 0,void 0,void 0,(function*(){try{const e=yield i.get("",{params:{page:"searchForms/translations"}}),{data:t,meta:a,success:s}=e.data;return s&&t?{data:t,meta:a}:null}catch(e){return console.warn({e}),null}}));if(e){const{data:a,meta:s}=e,{locale:n}=s,r=(0,H.d)({locale:n,messages:a},(0,M.Sn)());t(I.success({currentLocale:n,intl:r}))}})))),success:(0,c.HA)("translations/success"),failure:(0,c.HA)("translations/failure")},k={intlShape:(0,H.d)({locale:"en",messages:{},defaultLocale:"en"},(0,M.Sn)()),currentLocale:"en"},F=(0,c.xy)("translations",k,(e=>[e(I.success,((e,t)=>Object.assign(Object.assign({},e),{intlShape:t.intl,currentLocale:t.currentLocale})))])),B=(0,c.UI)(F,(e=>e.intlShape)),D=(0,c.UI)(F,(e=>e.currentLocale)),T=(0,c.UI)(D,(e=>"ru"===e?"ru":"en"));var q=a(60130),z=a(66726),R=a.n(z),U=a(23236),L=a(69032),V=a(33711),$=function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function l(e){try{i(s.next(e))}catch(e){r(e)}}function o(e){try{i(s.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}i((s=s.apply(e,t||[])).next())}))};const K=e=>{const{value:t,allowClear:a,debounce:n=300,onChange:r,fetchOptions:l,itemsEqual:o,inputValueRenderer:i,itemRenderer:c,inputProps:d,disabled:m}=e,[g,f]=(0,s.useState)([]),h=e=>{r&&r(e)},y=R()((e=>$(void 0,void 0,void 0,(function*(){var t;if(e.length){const a=null!==(t=yield l(e))&&void 0!==t?t:[];f(a)}}))),n);return s.createElement(U.U,{onQueryChange:y,selectedItem:t,items:g,inputValueRenderer:i,noResults:s.createElement(s.Fragment,null),fill:!0,popoverProps:(0,L.Jw)(g),itemsEqual:o,itemRenderer:c,onItemSelect:h,resetOnSelect:!0,disabled:m,inputProps:Object.assign(Object.assign({},d),{rightElement:a&&!m&&t?s.createElement(p.Vp,{className:u()(V.stylesTagWrapper),minimal:!0,round:!0,interactive:!0,icon:"small-cross",onClick:()=>h(null)}):void 0}),itemListRenderer:L.E8})};var W=function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function l(e){try{i(s.next(e))}catch(e){r(e)}}function o(e){try{i(s.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}i((s=s.apply(e,t||[])).next())}))},Z=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a};const G=e=>{const{value:t,allowClear:a,debounce:n=300,onChange:r,inputProps:o,locale:i="en",disabled:c}=e;return s.createElement(K,{value:t,fetchOptions:e=>W(void 0,void 0,void 0,(function*(){try{const{data:t}=yield l().get("https://autocomplete.travelpayouts.com/places2",{params:{term:e,locale:i,types:["city"]}});return t.map((e=>{var{cases:t,index_strings:a,country_cases:s}=e;return Z(e,["cases","index_strings","country_cases"])}))}catch(e){return console.warn({e}),[]}})),inputValueRenderer:e=>e?`${e.name}, ${e.country_name}`:"",itemRenderer:(0,L.uj)((e=>`${e.name}, ${e.country_name}`)),itemsEqual:"code",onChange:r,allowClear:a,debounce:n,inputProps:o,disabled:c})};var J=function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function l(e){try{i(s.next(e))}catch(e){r(e)}}function o(e){try{i(s.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}i((s=s.apply(e,t||[])).next())}))};const Y=e=>{const{value:t,allowClear:a,debounce:n=300,onChange:r,inputProps:o,locale:i="en",disabled:c}=e;return s.createElement(K,{value:t,fetchOptions:e=>J(void 0,void 0,void 0,(function*(){try{const{data:t}=yield l().get("https://yasen.hotellook.com/autocomplete",{params:{term:e,lang:i}}),{cities:a,hotels:s}=t,n=s.map((e=>({name:e.name,location:e.locationFullName,hotels_count:"",search_id:e.id,search_type:"hotel",country_name:e.country}))),r=a.map((e=>({name:e.city,location:e.fullname,hotels_count:"",search_id:e.id,search_type:"city",country_name:e.country})));return[...n,...r]}catch(e){return[]}})),inputValueRenderer:e=>e?`${e.name}, ${e.location}`:"",itemRenderer:(0,L.uj)((e=>`${e.name}, ${e.location}`)),itemsEqual:"search_id",onChange:r,allowClear:a,debounce:n,inputProps:o,disabled:c})};var Q=a(45399);const X=e=>{const{item:t,closeDialog:a,onSubmit:n}=e,{formatMessage:r}=(0,g.Z)(),l=(0,q.KO)(je),o=(0,q.KO)(T),i=(0,q.BH)(Pe),c=null!=t?t:{code_form:"",title:"",from_city:null,to_city:null,hotel_city:null,applyParams:!1},d=(0,j.TA)({initialValues:c,onSubmit:n});return(0,s.useEffect)((()=>{l.errors&&Object.entries(l.errors).forEach((([e,t])=>{const[a]=t;d.setFieldError(e,a)}))}),[l]),s.createElement("form",{onSubmit:d.handleSubmit},s.createElement(p.cw,{label:r({id:"item_title",defaultMessage:"Title"}),labelFor:"title",labelInfo:"*"},s.createElement(p.BZ,{id:"title",name:"title",onChange:d.handleChange,value:d.values.title,intent:d.errors.title&&d.touched.title?"danger":void 0,autoFocus:!0}),d.errors.title&&d.touched.title&&s.createElement(p.UW,{className:u()(Q.stylesCalloutWrapper),intent:"danger",icon:null},d.errors.title)),s.createElement(p.cw,{label:r({id:"item_widget_code",defaultMessage:"Generated widget code"}),labelFor:"code_form",labelInfo:"*"},s.createElement(p.Kx,{className:u()(Q.stylesTextarea),id:"code_form",name:"code_form",growVertically:!1,fill:!0,onChange:d.handleChange,value:d.values.code_form,intent:d.errors.code_form&&d.touched.code_form?"danger":void 0}),d.errors.code_form&&d.touched.code_form&&s.createElement(p.UW,{className:u()(Q.stylesCalloutWrapper),intent:"danger",icon:null},d.errors.code_form)),s.createElement(p.cw,{labelFor:"applyParams"},s.createElement(p.XZ,{id:"applyParams",name:"applyParams",checked:d.values.applyParams,onChange:({target:e})=>{d.setFieldValue("applyParams",e.checked,!1)},label:r({id:"item_apply_params",defaultMessage:"Apply parameters (origin, destination, etc.) from generated widget code"})})),s.createElement(p.cw,{label:r({id:"item_from_city",defaultMessage:"Default departure city"}),labelFor:"from_city"},s.createElement(G,{value:d.values.from_city,allowClear:!0,onChange:e=>d.setFieldValue("from_city",e),inputProps:{id:"from_city",name:"from_city",placeholder:""},locale:o,disabled:d.values.applyParams})),s.createElement(p.cw,{label:r({id:"item_to_city",defaultMessage:"Default arrival city"}),labelFor:"to_city"},s.createElement(G,{value:d.values.to_city,allowClear:!0,onChange:e=>d.setFieldValue("to_city",e),inputProps:{id:"to_city",name:"to_city",placeholder:""},locale:o,disabled:d.values.applyParams})),s.createElement(p.cw,{label:r({id:"item_city_hotel",defaultMessage:"Default city or hotel"}),labelFor:"hotel_city"},s.createElement(Y,{value:d.values.hotel_city,allowClear:!0,onChange:e=>d.setFieldValue("hotel_city",e),inputProps:{id:"hotel_city",name:"hotel_city",placeholder:""},locale:o,disabled:d.values.applyParams})),s.createElement(C,{type:"small"},s.createElement(p.zx,{type:"button",onClick:()=>i(),icon:"help",minimal:!0}),s.createElement(p.zx,{onClick:()=>a(),tabIndex:1},r({id:"button_cancel",defaultMessage:"Cancel"})),s.createElement(p.zx,{onClick:()=>d.submitForm(),intent:"primary",tabIndex:0},r(t?{id:"button_save",defaultMessage:"Save"}:{id:"button_add",defaultMessage:"Add"}))))},[ee,te,ae]=(0,y.Oe)("create-update-search-form"),se=()=>s.createElement(v.V,{name:ae,bodyComponent:X,width:520,canEscapeKeyClose:!0,canOutsideClickClose:!1});var ne=function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function l(e){try{i(s.next(e))}catch(e){r(e)}}function o(e){try{i(s.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}i((s=s.apply(e,t||[])).next())}))};const re={request:(0,c.HA)("search-forms/fetch/request",((e,{dispatch:t})=>ne(void 0,void 0,void 0,(function*(){const e=yield o(void 0,void 0,void 0,(function*(){try{return(yield i.get("",{params:{page:"searchForms"}})).data}catch(e){return console.warn({e}),null}}));e?e.success&&t(re.success({data:e.data})):t(re.failure())})))),success:(0,c.HA)("search-forms/fetch/success"),failure:(0,c.HA)("search-forms/fetch/failure")},le={set:(0,c.HA)("search-forms/id/set"),clear:(0,c.HA)("search-forms/id/clear"),setMany:(0,c.HA)("search-forms/check")},oe={run:(0,c.HA)("search-forms/create/run",((e,{dispatch:t})=>ne(void 0,void 0,void 0,(function*(){t(we())})))),showDialog:(0,c.HA)("search-forms/create/showDialog",((e,{dispatch:t,getState:a})=>ne(void 0,void 0,void 0,(function*(){const{formatMessage:e}=a(B);t(ee({dialogProps:{onSubmit:e=>{t(oe.request({value:e}))}},dialogConfig:{title:e({id:"item_add_title",defaultMessage:"Add a new search form"})}}))})))),request:(0,c.HA)("search-forms/create/request",(({value:e},{dispatch:t,getState:a})=>ne(void 0,void 0,void 0,(function*(){const{formatMessage:s}=a(B);t(Se.hide("search-forms/create")),t(Se.hide("search-forms/create/failure")),t(Se.show({message:s({id:"request_processing",defaultMessage:"Sending data. Please wait"}),intent:"primary",icon:"more",id:"search-forms/create"}));const n=yield(r=e,o(void 0,void 0,void 0,(function*(){try{return(yield i.post("",{query:r},{params:{page:"searchForms/create"}})).data}catch(e){return console.warn({e}),null}})));var r;if(t(Se.hide("search-forms/create")),n)if(n.success){const{data:e}=n;t(re.success({data:[...a(Ne),e]})),t(oe.success())}else t(oe.failure({errors:n.data.errors}));else t(oe.failure())})))),success:(0,c.HA)("search-forms/update/success",((e,{getState:t,dispatch:a})=>{const{formatMessage:s}=t(B);a(Se.hide("search-forms/create")),a(Se.show({message:s({id:"item_create_success",defaultMessage:"Search form has been created"}),intent:"success",icon:"saved",id:"search-forms/create"})),a(ue.update({})),a(te())})),failure:(0,c.HA)("search-forms/update/failure",((e,{dispatch:t,getState:a})=>{const{formatMessage:s}=a(B);t(Se.show({message:s({id:"item_create_error",defaultMessage:"An error has occurred while creating the search form"}),intent:"danger",icon:"error",id:"search-forms/create/failure"})),t(ue.update({}))}))},ie={showDialog:(0,c.HA)("search-forms/update/showDialog",(({id:e},{dispatch:t,getState:a})=>ne(void 0,void 0,void 0,(function*(){t(le.set(e));const{formatMessage:s}=a(B),n=a(Re);n&&t(ee({dialogProps:{item:n,onSubmit:a=>ne(void 0,void 0,void 0,(function*(){t(ie.request({id:e,value:a}))}))},dialogConfig:{title:s({id:"item_edit_title",defaultMessage:'Edit the search form "{searchForm_name}"'},{searchForm_name:n.title})}}))})))),request:(0,c.HA)("search-forms/update/request",(({id:e,value:t},{dispatch:a,getState:s})=>ne(void 0,void 0,void 0,(function*(){const{formatMessage:n}=s(B);a(Se.hide("search-forms/update")),a(Se.show({message:n({id:"request_processing",defaultMessage:"Sending data. Please wait"}),intent:"primary",icon:"more",id:"search-forms/update"})),a(Se.hide("search-forms/update/failure"));const r=yield(l=e,c=t,o(void 0,void 0,void 0,(function*(){try{return(yield i.put("",{query:c},{params:{page:`searchForms/update/${l}`}})).data}catch(e){return console.warn({e}),null}})));var l,c;if(r)if(a(Se.hide("search-forms/update")),r.success){const{data:e,meta:t}=r,n=s(Ne).filter((({id:e})=>e!==t.id));a(re.success({data:[...n,e]})),a(ie.success())}else a(ie.failure({errors:r.data.errors}));else a(ie.failure())})))),success:(0,c.HA)("search-forms/update/success",((e,{getState:t,dispatch:a})=>{const{formatMessage:s}=t(B);a(Se.hide("search-forms/update")),a(Se.show({message:s({id:"item_update_success",defaultMessage:"Search form has been updated"}),intent:"success",icon:"saved",id:"search-forms/update"})),a(ue.update({})),a(te())})),failure:(0,c.HA)("search-forms/update/failure",((e,{dispatch:t,getState:a})=>{const{formatMessage:s}=a(B);t(Se.show({message:s({id:"item_update_error",defaultMessage:"An error has occurred while updating the search form"}),intent:"danger",icon:"error",id:"search-forms/update/failure"})),t(ue.update({}))}))},ce={deleteSelectedItems:(0,c.HA)("search-forms/delete-many/request",((e,{dispatch:t,getState:a})=>ne(void 0,void 0,void 0,(function*(){const e=a(qe);e.length&&t(ce.showDialog({data:e}))})))),deleteOneItem:(0,c.HA)("search-forms/delete/request",(({id:e},{dispatch:t,getState:a})=>ne(void 0,void 0,void 0,(function*(){t(le.set(e));const s=a(Re);s&&t(ce.showDialog({data:[s]}))})))),showDialog:(0,c.HA)("search-forms/delete-many/show-dialog",(({data:e},{dispatch:t})=>ne(void 0,void 0,void 0,(function*(){const a=e.map((e=>e.id));t(Se.hide("search-forms/delete-many")),t(O({dialogProps:{items:e,onConfirm:()=>t(ce.success({idList:a}))}}))})))),success:(0,c.HA)("search-forms/delete-many/success",(({idList:e},{dispatch:t,getState:a})=>ne(void 0,void 0,void 0,(function*(){const{formatMessage:s}=a(B);t(Se.show({message:s({id:"request_processing",defaultMessage:"Sending data. Please wait"}),intent:"primary",icon:"more",id:"search-forms/delete-many"}));const n=yield(r=e,o(void 0,void 0,void 0,(function*(){try{const e=yield i.put("",{query:r},{params:{page:"searchForms/delete"}}),{data:t,success:a}=e.data;return a&&t?t:null}catch(e){return console.warn({e}),null}})));var r;if(n){const e=a(Ne).filter((({id:e})=>-1===n.indexOf(e)));t(re.success({data:e})),t(Se.hide("search-forms/delete-many")),t(Se.show({message:s({id:"request_delete_success",defaultMessage:"{num, plural, one {# search form} other {# search forms}} was successfully removed."},{num:n.length}),intent:"success",icon:"saved",id:"search-forms/delete-many"})),t(x()),t(de([]))}t(ue.update({}))})))),failure:(0,c.HA)("search-forms/delete-many/failure",((e,{dispatch:t})=>{t(ue.update({})),t(de([]))}))},de=(0,c.HA)("search-forms/check"),ue={set:(0,c.HA)("search-forms/output-selector/set"),update:(0,c.HA)("search-forms/output-selector/update",(({fireEvent:e=!0},{getState:t})=>ne(void 0,void 0,void 0,(function*(){const a=t(Ie);if(a){const t=yield o(void 0,void 0,void 0,(function*(){try{const e=yield i.get("",{params:{page:"searchForms/raw-data"}}),{data:t,success:a}=e.data;return a&&t?t:null}catch(e){return console.warn({e}),null}}));if(t){const s=new Event("change",{bubbles:!0});e&&(a.value=t,a.dispatchEvent(s))}}}))))};var me=a(41820);const ge=e=>{const{closeDialog:t}=e,{formatMessage:a}=(0,g.Z)(),n=(0,q.BH)(oe.showDialog),r=(0,q.BH)(Pe);return s.createElement("div",{className:u()(me.stylesActionBar)},s.createElement(p.zx,{className:u()(me.stylesActionBarButton),fill:!0,large:!0,autoFocus:!0,onClick:()=>{n(),t()},intent:"primary"},a({id:"introduce_form_code_exists",defaultMessage:"I have a generated widget code"})),s.createElement(p.zx,{className:u()(me.stylesActionBarButton),fill:!0,large:!0,onClick:()=>{r(),t()}},a({id:"introduce_form_code_not_exists",defaultMessage:"I don't have a code"})))},[pe,fe,he]=(0,y.Oe)("introduce-dialog"),ye=()=>s.createElement(s.Fragment,null,s.createElement(v.V,{name:he,bodyComponent:ge,width:400})),ve=e=>{const{formatMessage:t}=(0,g.Z)();return s.createElement("div",null,s.createElement("div",{className:u()("bp3-ui-text bp3-running-text bp3-text-large",me.stylesDescription)},t({id:"introduce_description",defaultMessage:"You need to create a new search form at Travelpayouts.com and get the widget code to add the form to the plugin"})),s.createElement("div",{className:u()(me.stylesActionBar)},s.createElement("div",{className:u()(me.stylesActionBarButton)},s.createElement(p.AN,{fill:!0,large:!0,href:"https://app.travelpayouts.com/programs/100/tools/search_forms",target:"_blank",text:t({id:"introduce_form_create_button",defaultMessage:"Create an {source} form"},{source:"Aviasales/Jetradar"})})),s.createElement("div",{className:u()(me.stylesActionBarButton)},s.createElement(p.AN,{fill:!0,large:!0,href:"https://app.travelpayouts.com/programs/101/tools/search_forms",target:"_blank",text:t({id:"introduce_form_create_button",defaultMessage:"Create an {source} form"},{source:"Hotellook"})}))),s.createElement("div",{className:u()(me.stylesHelpLink)},t({id:"introduce_form_tutorial_link",defaultMessage:"Here is a {tutorial_link} in help"},{tutorial_link:s.createElement("a",{target:"_blank",href:"https://support.travelpayouts.com/hc/en-us/articles/115000456691-Adding-Search-Forms-with-plugin"},t({id:"introduce_form_tutorial_link_title",defaultMessage:"tutorial"}))})),s.createElement(C,{type:"small"},s.createElement(p.zx,{intent:"primary",onClick:()=>e.onConfirm()},t({id:"introduce_form_ok",defaultMessage:"Ok, got it"}))))},[_e,be,Ee]=(0,y.Oe)("help-dialog"),Ce=()=>s.createElement(v.V,{name:Ee,bodyComponent:ve,width:500}),we=(0,c.HA)("search-forms/introduce/step-one",((e,{dispatch:t,getState:a})=>{const{formatMessage:s}=a(B);t(pe({dialogConfig:{title:s({id:"item_add_title",defaultMessage:"Add a new search form"})}}))})),Pe=(0,c.HA)("search-forms/introduce/step-two",((e,{dispatch:t})=>{t(_e({dialogProps:{onConfirm:()=>{t(be()),t(oe.showDialog())}}}))}));var Oe=a(80062),xe=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a};const Se={show:(0,c.HA)("toast/show",(e=>{const{id:t}=e,a=xe(e,["id"]);Oe.R.show(a,t)})),hide:(0,c.HA)("toast/hide",(e=>{Oe.R.dismiss(e)}))},Ae=(0,c.xy)("searchForms",{isPending:!1,isSuccess:!1,data:[],currentSearchFormId:null,selectedSearchFormIds:[],outputSelector:null},(e=>[e(re.success,((e,{data:t})=>Object.assign(Object.assign({},e),{isPending:!1,isSuccess:!0,data:t}))),e(re.request,(e=>Object.assign(Object.assign({},e),{isPending:!0,isSuccess:!1}))),e(re.failure,(e=>Object.assign(Object.assign({},e),{isPending:!1,isSuccess:!1}))),e(le.set,((e,t)=>Object.assign(Object.assign({},e),{currentSearchFormId:t}))),e(le.clear,(e=>Object.assign(Object.assign({},e),{currentSearchFormId:null}))),e(le.setMany,((e,t)=>Object.assign(Object.assign({},e),{selectedSearchFormIds:t}))),e(ue.set,((e,t)=>Object.assign(Object.assign({},e),{outputSelector:t})))])),je=(0,c.xy)("searchFormBackendErrorsAtom",{errors:null},(e=>[e(ie.request,(e=>Object.assign(Object.assign({},e),{errors:null}))),e(oe.request,(e=>Object.assign(Object.assign({},e),{errors:null}))),e(ie.success,(e=>Object.assign(Object.assign({},e),{errors:null}))),e(oe.success,(e=>Object.assign(Object.assign({},e),{errors:null}))),e(oe.failure,((e,t)=>t?Object.assign(Object.assign({},e),{errors:t.errors}):Object.assign(Object.assign({},e),{errors:null}))),e(ie.failure,((e,t)=>t?Object.assign(Object.assign({},e),{errors:t.errors}):Object.assign(Object.assign({},e),{errors:null})))]));var He=a(83078),Me=a(36248);const Ne=(0,c.UI)(Ae,(e=>e.data)),Ie=(0,c.UI)(Ae,(e=>e.outputSelector)),ke=(0,c.UI)((0,c.$e)([Ne,B]),(([e,t])=>{const{formatDate:a}=t;return e.map((e=>{const t=(0,Me.Z)(e.date_add,"yyyy-MM-dd",new Date);return Object.assign(Object.assign({},e),{date_add:(0,He.Z)(t)?a(t):e.date_add})}))})),Fe=(0,c.UI)(ke,(e=>e.sort(((e,t)=>e.id<t.id?1:-1)))),Be=(0,c.UI)(Ae,(e=>e.isPending)),De=(0,c.UI)(Ae,(e=>e.currentSearchFormId)),Te=(0,c.UI)(Ae,(e=>e.selectedSearchFormIds)),qe=(0,c.UI)((0,c.$e)([Ne,Te]),(([e,t])=>e.filter((({id:e})=>-1!==t.indexOf(e.toString()))))),ze=(0,c.UI)(qe,(e=>e.length)),Re=(0,c.UI)((0,c.$e)([Ne,De]),(([e,t])=>{const a=e.find((e=>e.id===t));return null!=a?a:null}));a(96341);const Ue=()=>s.createElement(s.Fragment,null,s.createElement(se,null),s.createElement(A,null),s.createElement(ye,null),s.createElement(Ce,null));var Le=a(60378),Ve=a(54016);const $e=e=>s.createElement(p.XZ,Object.assign({className:Ve.stylesCheckbox},e)),Ke=e=>{const{canPreviousPage:t,canNextPage:a,pageOptions:n,pageCount:r,gotoPage:l,nextPage:o,previousPage:i,pageIndex:c}=e;return s.createElement("div",{className:u()("pagination",Ve.stylesPagination)},s.createElement(p.hE,null,s.createElement(p.zx,{onClick:()=>l(0),disabled:!t},s.createElement(p.JO,{icon:"double-chevron-left"})),s.createElement(p.zx,{onClick:()=>i(),disabled:!t},s.createElement(p.JO,{icon:"chevron-left"}))),s.createElement("div",{className:u()(Ve.stylesPaginationTotalPages)},s.createElement("div",{className:u()(Ve.stylesPaginationTotalPagesPageNumber)},c+1),s.createElement("div",{className:u()(Ve.stylesPaginationTotalPagesDelimiter)},"/"),s.createElement("div",{className:u()(Ve.stylesPaginationTotalPagesPageNumber)},n.length)),s.createElement(p.hE,null,s.createElement(p.zx,{onClick:()=>o(),disabled:!a},s.createElement(p.JO,{icon:"chevron-right"})),s.createElement(p.zx,{onClick:()=>l(r-1),disabled:!a},s.createElement(p.JO,{icon:"double-chevron-right"}))))},We=e=>{const{data:t,columns:a,onSelect:n,showHeaderSelection:r,getRowId:l,pageSize:o,currentPage:i=0,onChangePage:c,fill:d,bordered:m,condensed:g,interactive:f,striped:h,paginationContainerClassName:y,tableContainerClassName:v,isLoading:_,noDataPlaceholder:b}=e,E=s.useMemo((()=>a),[a]),C=s.useMemo((()=>t),[t]),{getTableProps:w,getTableBodyProps:P,headerGroups:O,flatHeaders:x,prepareRow:S,page:A,canPreviousPage:j,canNextPage:H,pageOptions:M,pageCount:N,gotoPage:I,nextPage:k,previousPage:F,setPageSize:B,state:{pageIndex:D,pageSize:T,selectedRowIds:q}}=(0,Le.useTable)({columns:E,data:C,initialState:{pageIndex:i,pageSize:o},getRowId:l},Le.usePagination,Le.useRowSelect,(e=>{n&&e.visibleColumns.push((e=>[{id:"selection",headerClassName:Ve.stylesCheckboxCell,Header:({getToggleAllRowsSelectedProps:e})=>r?s.createElement($e,Object.assign({},e())):null,Cell:({row:e})=>s.createElement($e,Object.assign({},e.getToggleRowSelectedProps()))},...e]))})),z={page:A,canPreviousPage:j,canNextPage:H,pageOptions:M,pageCount:N,gotoPage:I,nextPage:k,previousPage:F,setPageSize:B,pageIndex:D,pageSize:T};return(0,s.useEffect)((()=>{D!==i&&I(i)}),[i]),(0,s.useEffect)((()=>{c&&D!==i&&c(D)}),[D]),(0,s.useEffect)((()=>{n&&n(Object.keys(q))}),[q]),s.createElement(s.Fragment,null,s.createElement("div",{className:v},s.createElement("table",Object.assign({className:u()("bp3-html-table",{"bp3-html-table-bordered":m,"bp3-html-table-condensed":g,"bp3-interactive":f,"bp3-html-table-striped":h,[Ve.stylesTableFill]:d})},w()),s.createElement("thead",null,O.map((e=>s.createElement("tr",Object.assign({},e.getHeaderGroupProps()),e.headers.map((e=>s.createElement("th",Object.assign({},e.getHeaderProps({className:e.headerClassName})),e.render("Header")))))))),s.createElement("tbody",Object.assign({},P()),A.map((e=>(S(e),s.createElement("tr",Object.assign({},e.getRowProps()),e.cells.map((e=>s.createElement("td",Object.assign({},e.getCellProps({className:e.column.cellClassName})),e.render("Cell")))))))),_&&s.createElement("tr",{role:"row"},s.createElement("td",{role:"cell",colSpan:x.length},s.createElement(p.$j,{size:32,className:Ve.stylesTableIsLoading}))),!_&&!!b&&0===C.length&&s.createElement("tr",{role:"row"},s.createElement("td",{role:"cell",colSpan:x.length},b))))),C.length>T?s.createElement("div",{className:y},s.createElement(Ke,Object.assign({},z))):null)};var Ze=a(88852);const Ge=()=>{const e=(0,q.BH)(re.request),t=(0,q.KO)(Fe),a=(0,q.KO)(Be),n=(0,q.BH)(ie.showDialog),r=(0,q.BH)(oe.run),l=(0,q.BH)(ce.deleteOneItem),o=(0,q.BH)(le.setMany),i=(0,q.BH)(ce.deleteSelectedItems),c=(0,q.KO)(ze),[d,m]=(0,s.useState)(0),{formatMessage:f}=(0,g.Z)();return(0,s.useEffect)((()=>{e()}),[]),s.createElement("div",null,s.createElement("div",{className:u()(Ze.stylesActionBar)},s.createElement(p.zx,{className:u()(Ze.stylesActionBarButton),intent:"primary",onClick:()=>{m(0),r()}},f({id:"button_add_new_item",defaultMessage:"Add a new search form"})),c>0&&s.createElement(p.zx,{className:u()(Ze.stylesActionBarButton),intent:"danger",icon:"trash",onClick:()=>i()},f({id:"grid_button_remove_items",defaultMessage:"Remove {num, plural, one {# item} other {# items}}"},{num:c}))),s.createElement(We,{paginationContainerClassName:Ze.stylesGridPagination,pageSize:10,data:t,onSelect:t.length?o:void 0,currentPage:d,onChangePage:m,columns:[{id:"title",accessor:"title",Header:f({id:"grid_column_title",defaultMessage:"Title"})},{id:"date",accessor:"date_add",Header:f({id:"grid_column_date",defaultMessage:"Date"}),headerClassName:Ze.stylesGridCellDate,cellClassName:Ze.stylesGridCellDate},{id:"shortcode",accessor:"id",Header:f({id:"grid_column_shortcode",defaultMessage:"Shortcode"}),Cell:({value:e})=>s.createElement(s.Fragment,null,'[tp_search_shortcodes id="',e,'"]')},{id:"actions",accessor:"id",Header:f({id:"grid_column_actions",defaultMessage:"Actions"}),headerClassName:Ze.stylesGridCellActions,cellClassName:Ze.stylesGridCellActions,Cell:e=>{const{value:t}=e;return s.createElement(p.hE,null,s.createElement(p.zx,{icon:"edit",intent:"primary",minimal:!0,onClick:()=>n({id:t})},f({id:"button_edit",defaultMessage:"Edit"})),s.createElement(p.zx,{icon:"trash",intent:"danger",minimal:!0,onClick:()=>l({id:t})},f({id:"button_delete",defaultMessage:"Delete"})))}}],showHeaderSelection:t.length>0,getRowId:e=>e.id.toString(),bordered:!0,striped:!0,interactive:!0,fill:!0,isLoading:a,noDataPlaceholder:s.createElement("div",{style:{margin:"15px 0",textAlign:"center"}},s.createElement("div",{className:"bp3-ui-text bp3-text-large bp3-running-text bp3-text-muted bp3-text-disabled"},f({id:"grid_empty",defaultMessage:"You don't have any form added yet"})))}))},Je=(0,c.$e)([y.pE,Ae,F]),Ye=(0,c.MT)(Je),Qe=e=>{const{outputSelector:t,apiUrl:a}=e,r=(0,q.BH)(I.request),l=(0,q.KO)(B),o=(0,q.BH)(ue.set),c=(0,q.BH)(ue.update);return a&&(i.defaults.baseURL=a),(0,s.useEffect)((()=>{if(r(),t){const e=document.querySelector(t);e&&(o(e),c({fireEvent:!1}))}}),[]),s.createElement(n.zt,{value:l},s.createElement(Ge,null),s.createElement(Ue,null))},Xe=e=>((0,s.useEffect)((()=>{0}),[]),s.createElement(q.Do.Provider,{value:Ye},s.createElement(Qe,Object.assign({},e))))}}]);